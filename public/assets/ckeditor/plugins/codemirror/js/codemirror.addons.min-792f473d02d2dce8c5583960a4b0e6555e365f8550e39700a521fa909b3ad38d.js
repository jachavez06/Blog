(function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){function t(e,t){return"pairs"==t&&"string"==typeof e?e:"object"==typeof e&&null!=e[t]?e[t]:m[t]}function n(e){return function(t){return a(t,e)}}function o(e){var t,n=e.state.closeBrackets;return n?(t=e.getModeAt(e.getCursor()),t.closeBrackets||n):null}function i(n){var i,r,l,a,s,f=o(n);if(!f||n.getOption("disableInput"))return e.Pass;for(i=t(f,"pairs"),r=n.listSelections(),a=0;a<r.length;a++)if(!r[a].empty()||!(l=c(n,r[a].head))||i.indexOf(l)%2!=0)return e.Pass;for(a=r.length-1;a>=0;a--)s=r[a].head,n.replaceRange("",p(s.line,s.ch-1),p(s.line,s.ch+1),"+delete")}function r(n){var i,r,l,a=o(n),s=a&&t(a,"explode");if(!s||n.getOption("disableInput"))return e.Pass;for(i=n.listSelections(),r=0;r<i.length;r++)if(!i[r].empty()||!(l=c(n,i[r].head))||s.indexOf(l)%2!=0)return e.Pass;n.operation(function(){var e,t;for(n.replaceSelection("\n\n",null),n.execCommand("goCharLeft"),i=n.listSelections(),e=0;e<i.length;e++)t=i[e].head.line,n.indentLine(t,null,!0),n.indentLine(t+1,null,!0)})}function l(t){var n=e.cmpPos(t.anchor,t.head)>0;return{anchor:new p(t.anchor.line,t.anchor.ch+(n?-1:1)),head:new p(t.head.line,t.head.ch+(n?1:-1))}}function a(n,i){var r,a,c,d,g,h=o(n);if(!h||n.getOption("disableInput")||(r=t(h,"pairs"),-1==(a=r.indexOf(i))))return e.Pass;var m,v=t(h,"triples"),b=r.charAt(a+1)==i,y=n.listSelections(),x=a%2==0;for(c=0;c<y.length;c++){var C,k=y[c],M=k.head,L=n.getRange(M,p(M.line,M.ch+1));if(x&&!k.empty())C="surround";else if(!b&&x||L!=i)if(b&&M.ch>1&&v.indexOf(i)>=0&&n.getRange(p(M.line,M.ch-2),M)==i+i&&(M.ch<=2||n.getRange(p(M.line,M.ch-3),p(M.line,M.ch-2))!=i))C="addFour";else if(b){if(e.isWordChar(L)||!f(n,M,i))return e.Pass;C="both"}else{if(!x||n.getLine(M.line).length!=M.ch&&!s(L,r)&&!/\s/.test(L))return e.Pass;C="both"}else C=b&&u(n,M)?"both":v.indexOf(i)>=0&&n.getRange(M,p(M.line,M.ch+3))==i+i+i?"skipThree":"skip";if(m){if(m!=C)return e.Pass}else m=C}d=a%2?r.charAt(a-1):i,g=a%2?i:r.charAt(a+1),n.operation(function(){var e,t;if("skip"==m)n.execCommand("goCharRight");else if("skipThree"==m)for(t=0;t<3;t++)n.execCommand("goCharRight");else if("surround"==m){for(e=n.getSelections(),t=0;t<e.length;t++)e[t]=d+e[t]+g;for(n.replaceSelections(e,"around"),e=n.listSelections().slice(),t=0;t<e.length;t++)e[t]=l(e[t]);n.setSelections(e)}else"both"==m?(n.replaceSelection(d+g,null),n.triggerElectric(d+g),n.execCommand("goCharLeft")):"addFour"==m&&(n.replaceSelection(d+d+d+d,"before"),n.execCommand("goCharRight"))})}function s(e,t){var n=t.lastIndexOf(e);return n>-1&&n%2==1}function c(e,t){var n=e.getRange(p(t.line,t.ch-1),p(t.line,t.ch+1));return 2==n.length?n:null}function f(t,n,o){var i,r,l=t.getLine(n.line),a=t.getTokenAt(n);if(/\bstring2?\b/.test(a.type))return!1;for(i=new e.StringStream(l.slice(0,n.ch)+o+l.slice(n.ch),4),i.pos=i.start=a.start;;){if(r=t.getMode().token(i,a.state),i.pos>=n.ch+1)return/\bstring2?\b/.test(r);i.start=i.pos}}function u(e,t){var n=e.getTokenAt(p(t.line,t.ch+1));return/\bstring/.test(n.type)&&n.start==t.ch}var d,g,h,m={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},p=e.Pos;for(e.defineOption("autoCloseBrackets",!1,function(t,n,o){o&&o!=e.Init&&(t.removeKeyMap(g),t.state.closeBrackets=null),n&&(t.state.closeBrackets=n,t.addKeyMap(g))}),d=m.pairs+"`",g={Backspace:i,Enter:r},h=0;h<d.length;h++)g["'"+d.charAt(h)+"'"]=n(d.charAt(h))}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function t(t){var n,o,s,c,f,u,d;if(t.getOption("disableInput"))return e.Pass;for(n=t.listSelections(),o=[],f=0;f<n.length;f++){if(!n[f].empty())return e.Pass;var g=n[f].head,h=t.getTokenAt(g),m=e.innerMode(t.getMode(),h.state),p=m.state;if("xml"!=m.mode.name||!p.tagName)return e.Pass;var v=t.getOption("autoCloseTags"),b="html"==m.mode.configuration,y="object"==typeof v&&v.dontCloseTags||b&&l,x="object"==typeof v&&v.indentTags||b&&a,C=p.tagName;if(h.end>g.ch&&(C=C.slice(0,C.length-h.end+g.ch)),s=C.toLowerCase(),!C||"string"==h.type&&(h.end!=g.ch||!/[\"\']/.test(h.string.charAt(h.string.length-1))||1==h.string.length)||"tag"==h.type&&"closeTag"==p.type||h.string.indexOf("/")==h.string.length-1||y&&i(y,s)>-1||r(t,C,g,p,!0))return e.Pass;c=x&&i(x,s)>-1,o[f]={indent:c,text:">"+(c?"\n\n":"")+"</"+C+">",newPos:c?e.Pos(g.line+1,0):e.Pos(g.line,g.ch+1)}}for(f=n.length-1;f>=0;f--)u=o[f],t.replaceRange(u.text,n[f].head,n[f].anchor,"+insert"),d=t.listSelections().slice(0),d[f]={head:u.newPos,anchor:u.newPos},t.setSelections(d),u.indent&&(t.indentLine(u.newPos.line,null,!0),t.indentLine(u.newPos.line+1,null,!0))}function n(t,n){for(var o,i=t.listSelections(),l=[],a=n?"/":"</",s=0;s<i.length;s++){if(!i[s].empty())return e.Pass;var c=i[s].head,f=t.getTokenAt(c),u=e.innerMode(t.getMode(),f.state),d=u.state;if(n&&("string"==f.type||"<"!=f.string.charAt(0)||f.start!=c.ch-1))return e.Pass;if("xml"!=u.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==u.mode.name)o=a+"script";else{if("htmlmixed"!=t.getMode().name||"css"!=u.mode.name)return e.Pass;o=a+"style"}else{if(!d.context||!d.context.tagName||r(t,d.context.tagName,c,d))return e.Pass;o=a+d.context.tagName}">"!=t.getLine(c.line).charAt(f.end)&&(o+=">"),l[s]=o}for(t.replaceSelections(l),i=t.listSelections(),s=0;s<i.length;s++)(s==i.length-1||i[s].head.line<i[s+1].head.line)&&t.indentLine(i[s].head.line)}function o(t){return t.getOption("disableInput")?e.Pass:n(t,!0)}function i(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;++n)if(e[n]==t)return n;return-1}function r(t,n,o,i,r){var l,a,s,c,f,u;if(!e.scanForClosingTag||(l=Math.min(t.lastLine()+1,o.line+500),!(a=e.scanForClosingTag(t,o,null,l))||a.tag!=n))return!1;for(s=i.context,c=r?1:0;s&&s.tagName==n;s=s.prev)++c;for(o=a.to,f=1;f<c;f++){if(!(u=e.scanForClosingTag(t,o,null,l))||u.tag!=n)return!1;o=u.to}return!0}e.defineOption("autoCloseTags",!1,function(n,i,r){if(r!=e.Init&&r&&n.removeKeyMap("autoCloseTags"),i){var l={name:"autoCloseTags"};("object"!=typeof i||i.whenClosing)&&(l["'/'"]=function(e){return o(e)}),("object"!=typeof i||i.whenOpening)&&(l["'>'"]=function(e){return t(e)}),n.addKeyMap(l)}});var l=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],a=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];e.commands.closeTag=function(e){return n(e)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(t){var o,i,r,l,a,s,c,f,u,d,g,h,m;if(t.getOption("disableInput"))return e.Pass;for(o=t.listSelections(),r=[],l=0;l<o.length;l++){if(a=o[l].head,s=t.getTokenAt(a),"comment"!=s.type)return e.Pass;if(c=e.innerMode(t.getMode(),s.state).mode,i){if(i!=c)return e.Pass}else i=c;if(f=null,i.blockCommentStart&&i.blockCommentContinue){if(u=s.string.indexOf(i.blockCommentEnd),d=t.getRange(e.Pos(a.line,0),e.Pos(a.line,s.end)),-1==u||u!=s.string.length-i.blockCommentEnd.length||!(a.ch>=u))if(0==s.string.indexOf(i.blockCommentStart)){if(f=d.slice(0,s.start),!/^\s*$/.test(f))for(f="",g=0;g<s.start;++g)f+=" "}else-1!=(m=d.indexOf(i.blockCommentContinue))&&m+i.blockCommentContinue.length>s.start&&/^\s*$/.test(d.slice(0,m))&&(f=d.slice(0,m));null!=f&&(f+=i.blockCommentContinue)}if(null==f&&i.lineComment&&n(t)&&(h=t.getLine(a.line),(m=h.indexOf(i.lineComment))>-1&&(f=h.slice(0,m),/\S/.test(f)?f=null:f+=i.lineComment+h.slice(m+i.lineComment.length).match(/^\s*/)[0])),null==f)return e.Pass;r[l]="\n"+f}t.operation(function(){for(var e=o.length-1;e>=0;e--)t.replaceRange(r[e],o[e].from(),o[e].to(),"+insert")})}function n(e){var t=e.getOption("continueComments");return!t||"object"!=typeof t||!1!==t.continueLineComment}for(var o=["clike","css","javascript"],i=0;i<o.length;++i)e.extendMode(o[i],{blockCommentContinue:" * "});e.defineOption("continueComments",null,function(n,o,i){var r,l;i&&i!=e.Init&&n.removeKeyMap("continueComment"),o&&(r="Enter","string"==typeof o?r=o:"object"==typeof o&&o.key&&(r=o.key),l={name:"continueComment"},l[r]=t,n.addKeyMap(l))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,o,i){var r,s,c,f=e.getLineHandle(t.line),u=t.ch-1,d=u>=0&&a[f.text.charAt(u)]||a[f.text.charAt(++u)];return d?(r=">"==d.charAt(1)?1:-1,o&&r>0!=(u==t.ch)?null:(s=e.getTokenTypeAt(l(t.line,u+1)),null==(c=n(e,l(t.line,u+(r>0?1:0)),r,s||null,i))?null:{from:l(t.line,u),to:c&&c.pos,match:c&&c.ch==d.charAt(0),forward:r>0})):null}function n(e,t,n,o,i){for(var r,s,c,f,u,d=i&&i.maxScanLineLength||1e4,g=i&&i.maxScanLines||1e3,h=[],m=i&&i.bracketRegex?i.bracketRegex:/[(){}[\]]/,p=n>0?Math.min(t.line+g,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-g),v=t.line;v!=p;v+=n)if((r=e.getLine(v))&&(s=n>0?0:r.length-1,c=n>0?r.length:-1,!(r.length>d)))for(v==t.line&&(s=t.ch-(n<0?1:0));s!=c;s+=n)if(f=r.charAt(s),m.test(f)&&(o===undefined||e.getTokenTypeAt(l(v,s+1))==o))if(u=a[f],">"==u.charAt(1)==n>0)h.push(f);else{if(!h.length)return{pos:l(v,s),ch:f};h.pop()}return v-n!=(n>0?e.lastLine():e.firstLine())&&null}function o(e,n,o){for(var i,a,s,c=e.state.matchBrackets.maxHighlightLineLength||1e3,f=[],u=e.listSelections(),d=0;d<u.length;d++)(i=u[d].empty()&&t(e,u[d].head,!1,o))&&e.getLine(i.from.line).length<=c&&(a=i.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",f.push(e.markText(i.from,l(i.from.line,i.from.ch+1),{className:a})),i.to&&e.getLine(i.to.line).length<=c&&f.push(e.markText(i.to,l(i.to.line,i.to.ch+1),{className:a})));if(f.length){if(r&&e.state.focused&&e.focus(),s=function(){e.operation(function(){for(var e=0;e<f.length;e++)f[e].clear()})},!n)return s;setTimeout(s,800)}}function i(e){e.operation(function(){s&&(s(),s=null),s=o(e,!1,e.state.matchBrackets)})}var r=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),l=e.Pos,a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},s=null;e.defineOption("matchBrackets",!1,function(t,n,o){o&&o!=e.Init&&(t.off("cursorActivity",i),s&&(s(),s=null)),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",i))}),e.defineExtension("matchBrackets",function(){o(this,!0)}),e.defineExtension("findMatchingBracket",function(e,n,o){return t(this,e,n,o)}),e.defineExtension("scanForBracket",function(e,t,o,i){return n(this,e,t,o,i)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){"use strict";function t(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function n(n){n.state.failedTagMatch=!1,n.operation(function(){var o,i,r,l,a;t(n),n.somethingSelected()||(o=n.getCursor(),i=n.getViewport(),i.from=Math.min(i.from,o.line),i.to=Math.max(o.line+1,i.to),(r=e.findMatchingTag(n,o,i))&&(n.state.matchBothTags&&(l="open"==r.at?r.open:r.close)&&(n.state.tagHit=n.markText(l.from,l.to,{className:"CodeMirror-matchingtag"})),a="close"==r.at?r.open:r.close,a?n.state.tagOther=n.markText(a.from,a.to,{className:"CodeMirror-matchingtag"}):n.state.failedTagMatch=!0))})}function o(e){e.state.failedTagMatch&&n(e)}e.defineOption("matchTags",!1,function(i,r,l){l&&l!=e.Init&&(i.off("cursorActivity",n),i.off("viewportChange",o),t(i)),r&&(i.state.matchBothTags="object"==typeof r&&r.bothTags,i.on("cursorActivity",n),i.on("viewportChange",o),n(i))}),e.commands.toMatchingTag=function(t){var n,o=e.findMatchingTag(t,t.getCursor());o&&(n="close"==o.at?o.open:o.close)&&t.extendSelection(n.to,n.from)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineOption("showTrailingSpace",!1,function(t,n,o){o==e.Init&&(o=!1),o&&!n?t.removeOverlay("trailingspace"):!o&&n&&t.addOverlay({token:function(e){for(var t=e.string.length,n=t;n&&/\s/.test(e.string.charAt(n-1));--n);return n>e.pos?(e.pos=n,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,i,r,l){function a(e){var n,o,r=s(t,i);if(!r||r.to.line-r.from.line<c)return null;for(n=t.findMarksAt(r.from),o=0;o<n.length;++o)if(n[o].__isFold&&"fold"!==l){if(!e)return null;r.cleared=!0,n[o].clear()}return r}var s,c,f,u,d;if(r&&r.call?(s=r,r=null):s=o(t,r,"rangeFinder"),"number"==typeof i&&(i=e.Pos(i,0)),c=o(t,r,"minFoldSize"),f=a(!0),o(t,r,"scanUp"))for(;!f&&i.line>t.firstLine();)i=e.Pos(i.line-1,0),f=a(!1);f&&!f.cleared&&"unfold"!==l&&(u=n(t,r),e.on(u,"mousedown",function(t){d.clear(),e.e_preventDefault(t)}),d=t.markText(f.from,f.to,{replacedWith:u,clearOnEnter:o(t,r,"clearOnEnter"),__isFold:!0}),d.on("clear",function(n,o){e.signal(t,"unfold",t,n,o)}),e.signal(t,"fold",t,f.from,f.to))}function n(e,t){var n,i=o(e,t,"widget");return"string"==typeof i&&(n=document.createTextNode(i),i=document.createElement("span"),i.appendChild(n),i.className="CodeMirror-foldmarker"),i}function o(e,t,n){if(t&&t[n]!==undefined)return t[n];var o=e.options.foldOptions;return o&&o[n]!==undefined?o[n]:i[n]}e.newFoldFunction=function(e,n){return function(o,i){t(o,i,{rangeFinder:e,widget:n})}},e.defineExtension("foldCode",function(e,n,o){t(this,e,n,o)}),e.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),n=0;n<t.length;++n)if(t[n].__isFold)return!0}),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation(function(){for(var n=t.firstLine(),o=t.lastLine();n<=o;n++)t.foldCode(e.Pos(n,0),null,"fold")})},e.commands.unfoldAll=function(t){t.operation(function(){for(var n=t.firstLine(),o=t.lastLine();n<=o;n++)t.foldCode(e.Pos(n,0),null,"unfold")})},e.registerHelper("fold","combine",function(){var e=Array.prototype.slice.call(arguments,0);return function(t,n){for(var o,i=0;i<e.length;++i)if(o=e[i](t,n))return o}}),e.registerHelper("fold","auto",function(e,t){for(var n,o=e.getHelpers(t,"fold"),i=0;i<o.length;i++)if(n=o[i](e,t))return n});var i={rangeFinder:e.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:!1,clearOnEnter:!0};e.defineOption("foldOptions",null),e.defineExtension("foldOption",function(e,t){return o(this,e,t)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options=e,this.from=this.to=0}function n(e){return!0===e&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function o(e,t){for(var n=e.findMarks(u(t,0),u(t+1,0)),o=0;o<n.length;++o)if(n[o].__isFold&&n[o].find().from.line==t)return n[o]}function i(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function r(e,t,n){var r=e.state.foldGutter.options,l=t,a=e.foldOption(r,"minFoldSize"),s=e.foldOption(r,"rangeFinder");e.eachLine(t,n,function(t){var n,c,f=null;o(e,l)?f=i(r.indicatorFolded):(n=u(l,0),(c=s&&s(e,n))&&c.to.line-c.from.line>=a&&(f=i(r.indicatorOpen))),e.setGutterMarker(t,r.gutter,f),++l})}function l(e){var t=e.getViewport(),n=e.state.foldGutter;n&&(e.operation(function(){r(e,t.from,t.to)}),n.from=t.from,n.to=t.to)}function a(e,t,n){var i,r,l=e.state.foldGutter;l&&(i=l.options,n==i.gutter)&&(r=o(e,t),r?r.clear():e.foldCode(u(t,0),i.rangeFinder))}function s(e){var t,n=e.state.foldGutter;n&&(t=n.options,n.from=n.to=0,clearTimeout(n.changeUpdate),n.changeUpdate=setTimeout(function(){l(e)},t.foldOnChangeTimeSpan||600))}function c(e){var t,n=e.state.foldGutter;n&&(t=n.options,clearTimeout(n.changeUpdate),n.changeUpdate=setTimeout(function(){var t=e.getViewport();n.from==n.to||t.from-n.to>20||n.from-t.to>20?l(e):e.operation(function(){t.from<n.from&&(r(e,t.from,n.from),n.from=t.from),t.to>n.to&&(r(e,n.to,t.to),n.to=t.to)})},t.updateViewportTimeSpan||400))}function f(e,t){var n,o=e.state.foldGutter;o&&(n=t.line)>=o.from&&n<o.to&&r(e,n,n+1)}e.defineOption("foldGutter",!1,function(o,i,r){r&&r!=e.Init&&(o.clearGutter(o.state.foldGutter.options.gutter),o.state.foldGutter=null,o.off("gutterClick",a),o.off("change",s),o.off("viewportChange",c),o.off("fold",f),o.off("unfold",f),o.off("swapDoc",s)),i&&(o.state.foldGutter=new t(n(i)),l(o),o.on("gutterClick",a),o.on("change",s),o.on("viewportChange",c),o.on("fold",f),o.on("unfold",f),o.on("swapDoc",s))});var u=e.Pos}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","brace",function(t,n){function o(o){for(var r,l=n.ch,a=0;;)if(-1!=(r=l<=0?-1:m.lastIndexOf(o,l-1))){if(1==a&&r<n.ch)break;if(i=t.getTokenTypeAt(e.Pos(h,r+1)),!/^(comment|string)/.test(i))return r+1;l=r-1}else{if(1==a)break;a=1,l=m.length}}var i,r,l,a,s,c,f,u,d,g,h=n.line,m=t.getLine(h),p="{",v="}",b=o("{");if(null==b&&(p="[",v="]",b=o("[")),null!=b){r=1,l=t.lastLine();e:for(c=h;c<=l;++c)for(f=t.getLine(c),u=c==h?b:0;d=f.indexOf(p,u),g=f.indexOf(v,u),d<0&&(d=f.length),g<0&&(g=f.length),(u=Math.min(d,g))!=f.length;){if(t.getTokenTypeAt(e.Pos(c,u+1))==i)if(u==d)++r;else if(!--r){a=c,s=u;break e}++u}if(null!=a&&(h!=a||s!=b))return{from:e.Pos(h,b),to:e.Pos(a,s)}}}),e.registerHelper("fold","import",function(t,n){function o(n){var o,i,r,l,a;if(n<t.firstLine()||n>t.lastLine()||(o=t.getTokenAt(e.Pos(n,1)),/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"keyword"!=o.type||"import"!=o.string))return null;for(i=n,r=Math.min(t.lastLine(),n+10);i<=r;++i)if(l=t.getLine(i),-1!=(a=l.indexOf(";")))return{startCh:o.end,end:e.Pos(i,a)}}var i,r,l,a=n.line,s=o(a);if(!s||o(a-1)||(i=o(a-2))&&i.end.line==a-1)return null;for(r=s.end;null!=(l=o(r.line+1));)r=l.end;return{from:t.clipPos(e.Pos(a,s.startCh+1)),to:r}}),e.registerHelper("fold","include",function(t,n){function o(n){if(n<t.firstLine()||n>t.lastLine())return null;var o=t.getTokenAt(e.Pos(n,1));return/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"meta"==o.type&&"#include"==o.string.slice(0,8)?o.start+8:void 0}var i,r=n.line,l=o(r);if(null==l||null!=o(r-1))return null;for(i=r;null!=o(i+1);)++i;return{from:e.Pos(r,l+1),to:t.clipPos(e.Pos(i))}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,n){var o,i,r,l,a,s,c,f,u,d,g,h,m,p,v,b=t.getModeAt(n),y=b.blockCommentStart,x=b.blockCommentEnd;if(y&&x){for(o=n.line,i=t.getLine(o),l=n.ch,a=0;;)if(-1!=(s=l<=0?-1:i.lastIndexOf(y,l-1))){if(1==a&&s<n.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(o,s+1)))&&(0==s||i.slice(s-x.length,s)==x||!/comment/.test(t.getTokenTypeAt(e.Pos(o,s))))){r=s+y.length;break}l=s-1}else{if(1==a)return;a=1,l=i.length}c=1,f=t.lastLine();e:for(g=o;g<=f;++g)for(h=t.getLine(g),m=g==o?r:0;p=h.indexOf(y,m),v=h.indexOf(x,m),p<0&&(p=h.length),v<0&&(v=h.length),(m=Math.min(p,v))!=h.length;){if(m==p)++c;else if(!--c){u=g,d=m;break e}++m}if(null!=u&&(o!=u||d!=r))return{from:e.Pos(o,r),to:e.Pos(u,d)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","indent",function(t,n){var o,i,r,l=t.getOption("tabSize"),a=t.getLine(n.line);if(/\S/.test(a)){var s=function(t){return e.countColumn(t,null,l)},c=s(a),f=null;for(o=n.line+1,i=t.lastLine();o<=i;++o)if(r=t.getLine(o),s(r)>c)f=o;else if(/\S/.test(r))break;if(f)return{from:e.Pos(n.line,a.length),to:e.Pos(f,t.getLine(f).length)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line-t.line||e.ch-t.ch}function n(e,t,n,o){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=o?Math.max(o.from,e.firstLine()):e.firstLine(),this.max=o?Math.min(o.to-1,e.lastLine()):e.lastLine()}function o(e,t){var n=e.cm.getTokenTypeAt(d(e.line,t));return n&&/\btag\b/.test(n)}function i(e){if(!(e.line>=e.max))return e.ch=0,e.text=e.cm.getLine(++e.line),!0}function r(e){if(!(e.line<=e.min))return e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0}function l(e){for(var t,n,r;;){if(-1==(t=e.text.indexOf(">",e.ch))){if(i(e))continue;return}{if(o(e,t+1))return n=e.text.lastIndexOf("/",t),r=n>-1&&!/\S/.test(e.text.slice(n+1,t)),e.ch=t+1,r?"selfClose":"regular";e.ch=t+1}}}function a(e){for(var t,n;;){if(-1==(t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1)){if(r(e))continue;return}if(o(e,t+1)){if(m.lastIndex=t,e.ch=t,(n=m.exec(e.text))&&n.index==t)return n}else e.ch=t}}function s(e){for(;;){m.lastIndex=e.ch;var t=m.exec(e.text);if(!t){if(i(e))continue;return}{if(o(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function c(e){for(var t,n,i;;){if(-1==(t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1)){if(r(e))continue;return}{if(o(e,t+1))return n=e.text.lastIndexOf("/",t),i=n>-1&&!/\S/.test(e.text.slice(n+1,t)),e.ch=t+1,i?"selfClose":"regular";e.ch=t}}}function f(e,t){for(var n,o=[];;){var i,r=s(e),a=e.line,c=e.ch-(r?r[0].length:0);if(!r||!(i=l(e)))return;if("selfClose"!=i)if(r[1]){for(n=o.length-1;n>=0;--n)if(o[n]==r[2]){o.length=n;break}if(n<0&&(!t||t==r[2]))return{tag:r[2],from:d(a,c),to:d(e.line,e.ch)}}else o.push(r[2])}}function u(e,t){for(var n,o,i=[];;){if(!(n=c(e)))return;if("selfClose"!=n){var r=e.line,l=e.ch,s=a(e);if(!s)return;if(s[1])i.push(s[2]);else{for(o=i.length-1;o>=0;--o)if(i[o]==s[2]){i.length=o;break}if(o<0&&(!t||t==s[2]))return{tag:s[2],from:d(e.line,e.ch),to:d(r,l)}}}else a(e)}}var d=e.Pos,g="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",h=g+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",m=new RegExp("<(/?)(["+g+"]["+h+"]*)","g");e.registerHelper("fold","xml",function(e,t){for(var o,i,r,a,c=new n(e,t.line,0);;){if(!(o=s(c))||c.line!=t.line||!(i=l(c)))return;if(!o[1]&&"selfClose"!=i)return r=d(c.line,c.ch),(a=f(c,o[2]))&&{from:r,to:a.from}}}),e.findMatchingTag=function(e,o,i){var r,s=new n(e,o.line,o.ch,i);if(-1!=s.text.indexOf(">")||-1!=s.text.indexOf("<")){var c=l(s),g=c&&d(s.line,s.ch),h=c&&a(s);if(c&&h&&!(t(s,o)>0))return r={from:d(s.line,s.ch),to:g,tag:h[2]},"selfClose"==c?{open:r,close:null,at:"open"}:h[1]?{open:u(s,h[2]),close:r,at:"close"}:(s=new n(e,g.line,g.ch,i),{open:r,close:f(s,h[2]),at:"open"})}},e.findEnclosingTag=function(e,t,o){for(var i,r,l,a=new n(e,t.line,t.ch,o);i=u(a);)if(r=new n(e,t.line,t.ch,o),l=f(r,i.tag))return{open:i,close:l}},e.scanForClosingTag=function(e,t,o,i){return f(new n(e,t.line,t.ch,i?{from:0,to:i}:null),o)}}),function(){CodeMirror.defineExtension("autoFormatAll",function(e,t){function n(){c+="\n",u=!0,++f}for(var o,i=this,r=i.getMode(),l=i.getRange(e,t).split("\n"),a=CodeMirror.copyState(r,i.getTokenAt(e).state),s=i.getOption("tabSize"),c="",f=0,u=0==e.ch,d=0;d<l.length;++d){for(o=new CodeMirror.StringStream(l[d],s);!o.eol();){var g=CodeMirror.innerMode(r,a),h=r.token(o,a),m=o.current();o.start=o.pos,(!u||/\S/.test(m))&&(c+=m,u=!1),!u&&g.mode.newlineAfterToken&&g.mode.newlineAfterToken(h,m,o.string.slice(o.pos)||l[d+1]||"",g.state)&&n()}!o.pos&&r.blankLine&&r.blankLine(a),!u&&d<l.length-1&&n()}i.operation(function(){i.replaceRange(c,e,t);for(var n=e.line+1,o=e.line+f;n<=o;++n)i.indentLine(n,"smart");i.setCursor({line:0,ch:0})})})}(),function(){function e(e){for(var t,n,o=[/for\s*?\((.*?)\)/g,/&#?[a-z0-9]+;[\s\S]/g,/\"(.*?)((\")|$)/g,/\/\*(.*?)(\*\/|$)/g,/^\/\/.*/g],i=[],r=0;r<o.length;r++)for(t=0;t<e.length&&null!=(n=e.substr(t).match(o[r]));)i.push({start:t+n.index,end:t+n.index+n[0].length}),t+=n.index+Math.max(1,n[0].length);return i.sort(function(e,t){return e.start-t.start}),i}CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(e,t){return/^[;{}]$/.test(t)}}),CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(t){var n,o=0,i=this.jsonMode?function(e){return e.replace(/([,{])/g,"$1\n").replace(/}/g,"\n}")}:function(e){return e.replace(/(;|\{|\})([^\r\n;])/g,"$1\n$2")},r=e(t),l="";if(null!=r){for(n=0;n<r.length;n++)r[n].start>o&&(l+=i(t.substring(o,r[n].start)),o=r[n].start),r[n].start<=o&&r[n].end>=o&&(l+=t.substring(o,r[n].end),o=r[n].end);o<t.length&&(l+=i(t.substr(o)))}else l=i(t);return l.replace(/^\n*|\n*$/,"")}}),CodeMirror.extendMode("xml",{commentStart:"<!--",commentEnd:"-->",noBreak:!1,noBreakEmpty:null,tagType:"",tagName:"",isXML:!1,newlineAfterToken:function(e,t,n){var o,i="a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u",r="label|li|option|textarea|title|"+i,l=!1,a=null,s="";if(this.isXML="xml"==this.configuration,"comment"==e||/<!--/.test(n))return!1;if("tag"==e){if(0==t.indexOf("<")&&0==!t.indexOf("</")&&(this.tagType="open",a=t.match(/^<\s*?([\w]+?)$/i),this.tagName=null!=a?a[1]:"",s=this.tagName.toLowerCase(),-1!=("|"+r+"|").indexOf("|"+s+"|")&&(this.noBreak=!0)),0==t.indexOf(">")&&"open"==this.tagType)return this.tagType="",o=this.isXML?"[^<]*?":"",RegExp("^"+o+"</s*?"+this.tagName+"s*?>","i").test(n)?(this.noBreak=!1,this.isXML||(this.tagName=""),!1):(l=this.noBreak,this.noBreak=!1,!l);if(0==t.indexOf("</")&&(this.tagType="close",a=t.match(/^<\/\s*?([\w]+?)$/i),null!=a&&(s=a[1].toLowerCase()),-1!=("|"+i+"|").indexOf("|"+s+"|")&&(this.noBreak=!0)),0==t.indexOf(">")&&"close"==this.tagType)return this.tagType="",0==n.indexOf("<")&&(a=n.match(/^<\/?\s*?([\w]+?)(\s|>)/i),s=null!=a?a[1].toLowerCase():"",-1==("|"+r+"|").indexOf("|"+s+"|"))?(this.noBreak=!1,!0):(l=this.noBreak,this.noBreak=!1,!l)}return 0==n.indexOf("<")&&(this.noBreak=!1,this.isXML&&""!=this.tagName?(this.tagName="",!1):(a=n.match(/^<\/?\s*?([\w]+?)(\s|>)/i),s=null!=a?a[1].toLowerCase():"",-1==("|"+r+"|").indexOf("|"+s+"|")))}}),CodeMirror.defineExtension("commentRange",function(e,t,n){var o=this,i=CodeMirror.innerMode(o.getMode(),o.getTokenAt(t).state).mode;o.operation(function(){if(e)o.replaceRange(i.commentEnd,n),o.replaceRange(i.commentStart,t),t.line==n.line&&t.ch==n.ch&&o.setCursor(t.line,t.ch+i.commentStart.length);else{var r=o.getRange(t,n),l=r.indexOf(i.commentStart),a=r.lastIndexOf(i.commentEnd);l>-1&&a>-1&&a>l&&(r=r.substr(0,l)+r.substring(l+i.commentStart.length,a)+r.substr(a+i.commentEnd.length)),o.replaceRange(r,t,n)}})}),CodeMirror.defineExtension("autoIndentRange",function(e,t){var n=this;this.operation(function(){for(var o=e.line;o<=t.line;o++)n.indentLine(o,"smart")})}),CodeMirror.defineExtension("autoFormatRange",function(e,t){function n(){c+="\n",u=!0,++f}for(var o,i=this,r=i.getMode(),l=i.getRange(e,t).split("\n"),a=CodeMirror.copyState(r,i.getTokenAt(e).state),s=i.getOption("tabSize"),c="",f=0,u=0==e.ch,d=0;d<l.length;++d){for(o=new CodeMirror.StringStream(l[d],s);!o.eol();){var g=CodeMirror.innerMode(r,a),h=r.token(o,a),m=o.current();o.start=o.pos,(!u||/\S/.test(m))&&(c+=m,u=!1),!u&&g.mode.newlineAfterToken&&g.mode.newlineAfterToken(h,m,o.string.slice(o.pos)||l[d+1]||"",g.state)&&n()}!o.pos&&r.blankLine&&r.blankLine(a),!u&&d<l.length-1&&n()}i.operation(function(){i.replaceRange(c,e,t);for(var n=e.line+1,o=e.line+f;n<=o;++n)i.indentLine(n,"smart");i.setSelection(e,i.getCursor(!1))})})}(),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){for(var t=0;t<e.state.activeLines.length;t++)e.removeLineClass(e.state.activeLines[t],"wrap",r),e.removeLineClass(e.state.activeLines[t],"background",l),e.removeLineClass(e.state.activeLines[t],"gutter",a)}function n(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function o(e,o){for(var i,s,c,f=[],u=0;u<o.length;u++)i=o[u],s=e.getOption("styleActiveLine"),("object"==typeof s&&s.nonEmpty?i.anchor.line==i.head.line:i.empty())&&(c=e.getLineHandleVisualStart(i.head.line),f[f.length-1]!=c&&f.push(c));n(e.state.activeLines,f)||e.operation(function(){t(e);for(var n=0;n<f.length;n++)e.addLineClass(f[n],"wrap",r),e.addLineClass(f[n],"background",l),e.addLineClass(f[n],"gutter",a);e.state.activeLines=f})}function i(e,t){o(e,t.ranges)}var r="CodeMirror-activeline",l="CodeMirror-activeline-background",a="CodeMirror-activeline-gutter";e.defineOption("styleActiveLine",!1,function(n,r,l){var a=l!=e.Init&&l;r!=a&&(a&&(n.off("beforeSelectionChange",i),t(n),delete n.state.activeLines),r)&&(n.state.activeLines=[],o(n,n.listSelections()),n.on("beforeSelectionChange",i))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./matchesonscrollbar"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options={};for(var t in u)this.options[t]=(e&&e.hasOwnProperty(t)?e:u)[t];this.overlay=this.timeout=null,this.matchesonscroll=null,this.active=!1}function n(e){var t=e.state.matchHighlighter;(t.active||e.hasFocus())&&i(e,t)}function o(e){var t=e.state.matchHighlighter;t.active||(t.active=!0,i(e,t))}function i(e,t){clearTimeout(t.timeout),t.timeout=setTimeout(function(){a(e)},t.options.delay)}function r(e,t,n,o){var i,r=e.state.matchHighlighter;e.addOverlay(r.overlay=f(t,n,o)),r.options.annotateScrollbar&&e.showMatchesOnScrollbar&&(i=n?new RegExp("\\b"+t+"\\b"):t,r.matchesonscroll=e.showMatchesOnScrollbar(i,!1,{className:"CodeMirror-selection-highlight-scrollbar"}))}function l(e){var t=e.state.matchHighlighter;t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null,t.matchesonscroll&&(t.matchesonscroll.clear(),t.matchesonscroll=null))}function a(e){e.operation(function(){var t,n,o,i=e.state.matchHighlighter;if(l(e),!e.somethingSelected()&&i.options.showToken){for(var a=!0===i.options.showToken?/[\w$]/:i.options.showToken,c=e.getCursor(),f=e.getLine(c.line),u=c.ch,d=u;u&&a.test(f.charAt(u-1));)--u;for(;d<f.length&&a.test(f.charAt(d));)++d;return void(u<d&&r(e,f.slice(u,d),a,i.options.style))}t=e.getCursor("from"),n=e.getCursor("to"),t.line==n.line&&(!i.options.wordsOnly||s(e,t,n))&&(o=e.getRange(t,n),i.options.trim&&(o=o.replace(/^\s+|\s+$/g,"")),o.length>=i.options.minChars&&r(e,o,!1,i.options.style))})}function s(e,t,n){var o,i,r=e.getRange(t,n);return null!==r.match(/^\w+$/)&&(!(t.ch>0&&(o={line:t.line,ch:t.ch-1},i=e.getRange(o,t),null===i.match(/\W/)))&&!(n.ch<e.getLine(t.line).length&&(o={line:n.line,ch:n.ch+1},i=e.getRange(n,o),null===i.match(/\W/))))}function c(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}function f(e,t,n){return{token:function(o){if(o.match(e)&&(!t||c(o,t)))return n;o.next(),o.skipTo(e.charAt(0))||o.skipToEnd()}}}var u={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};e.defineOption("highlightSelectionMatches",!1,function(i,r,s){if(s&&s!=e.Init&&(l(i),clearTimeout(i.state.matchHighlighter.timeout),i.state.matchHighlighter=null,i.off("cursorActivity",n),i.off("focus",o)),r){var c=i.state.matchHighlighter=new t(r)
;i.hasFocus()?(c.active=!0,a(i)):i.on("focus",o),i.on("cursorActivity",n)}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.multiplexingMode=function(t){function n(e,t,n,o){var i,r;return"string"==typeof t?(i=e.indexOf(t,n),o&&i>-1?i+t.length:i):(r=t.exec(n?e.slice(n):e),r?r.index+n+(o?r[0].length:0):-1)}var o=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:e.startState(t),innerActive:null,inner:null}},copyState:function(n){return{outer:e.copyState(t,n.outer),innerActive:n.innerActive,inner:n.innerActive&&e.copyState(n.innerActive.mode,n.inner)}},token:function(i,r){var l,a,s,c,f,u,d,g;if(r.innerActive)return f=r.innerActive,u=i.string,!f.close&&i.sol()?(r.innerActive=r.inner=null,this.token(i,r)):(d=f.close?n(u,f.close,i.pos,f.parseDelimiters):-1)!=i.pos||f.parseDelimiters?(d>-1&&(i.string=u.slice(0,d)),g=f.mode.token(i,r.inner),d>-1&&(i.string=u),d==i.pos&&f.parseDelimiters&&(r.innerActive=r.inner=null),f.innerStyle&&(g=g?g+" "+f.innerStyle:f.innerStyle),g):(i.match(f.close),r.innerActive=r.inner=null,f.delimStyle&&f.delimStyle+" "+f.delimStyle+"-close");for(l=Infinity,u=i.string,a=0;a<o.length;++a){if(s=o[a],(d=n(u,s.open,i.pos))==i.pos)return s.parseDelimiters||i.match(s.open),r.innerActive=s,r.inner=e.startState(s.mode,t.indent?t.indent(r.outer,""):0),s.delimStyle&&s.delimStyle+" "+s.delimStyle+"-open";-1!=d&&d<l&&(l=d)}return l!=Infinity&&(i.string=u.slice(0,l)),c=t.token(i,r.outer),l!=Infinity&&(i.string=u),c},indent:function(n,o){var i=n.innerActive?n.innerActive.mode:t;return i.indent?i.indent(n.innerActive?n.inner:n.outer,o):e.Pass},blankLine:function(n){var i,r,l=n.innerActive?n.innerActive.mode:t;if(l.blankLine&&l.blankLine(n.innerActive?n.inner:n.outer),n.innerActive)"\n"===n.innerActive.close&&(n.innerActive=n.inner=null);else for(i=0;i<o.length;++i)r=o[i],"\n"===r.open&&(n.innerActive=r,n.inner=e.startState(r.mode,l.indent?l.indent(n.outer,""):0))},electricChars:t.electricChars,innerMode:function(e){return e.inner?{state:e.inner,mode:e.innerActive.mode}:{state:e.outer,mode:t}}}}});