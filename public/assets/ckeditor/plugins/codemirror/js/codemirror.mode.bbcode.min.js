CodeMirror.defineMode("bbcode",function(e){var t,n,r;t={bbCodeTags:"b i u s img quote code list table  tr td size color url",bbCodeUnaryTags:"* :-) hr cut"},e.hasOwnProperty("bbCodeTags")&&(t.bbCodeTags=e.bbCodeTags),e.hasOwnProperty("bbCodeUnaryTags")&&(t.bbCodeUnaryTags=e.bbCodeUnaryTags);var a={cont:function(e,t){return r=t,e},escapeRegEx:function(e){return e.replace(/([\:\-\)\(\*\+\?\[\]])/g,"\\$1")}},o={validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/,tags:new RegExp("(?:"+a.escapeRegEx(t.bbCodeTags).split(" ").join("|")+")"),unaryTags:new RegExp("(?:"+a.escapeRegEx(t.bbCodeUnaryTags).split(" ").join("|")+")")},i={tokenizer:function(e,t){return e.eatSpace()?null:e.match("[",!0)?(t.tokenize=i.bbcode,a.cont("tag","startTag")):(e.next(),null)},inAttribute:function(e){return function(t,n){for(var r=null,a=null;!t.eol();){if(a=t.peek(),t.next()==e&&"\\"!==r){n.tokenize=i.bbcode;break}r=a}return"string"}},bbcode:function(e,t){if(n=e.match("]",!0))return t.tokenize=i.tokenizer,a.cont("tag",null);if(e.match("[",!0))return a.cont("tag","startTag");var s=e.next();if(o.stringChar.test(s))return t.tokenize=i.inAttribute(s),a.cont("string","string");if(/\d/.test(s))return e.eatWhile(/\d/),a.cont("number","number");if("whitespace"==t.last)return e.eatWhile(o.validIdentifier),a.cont("attribute","modifier");if("property"==t.last)return e.eatWhile(o.validIdentifier),a.cont("property",null);if(/\s/.test(s))return r="whitespace",null;var u="";"/"!=s&&(u+=s);for(var b=null;b=e.eat(o.validIdentifier);)u+=b;return o.unaryTags.test(u)?a.cont("atom","atom"):o.tags.test(u)?a.cont("keyword","keyword"):/\s/.test(s)?null:a.cont("tag","tag")}};return{startState:function(){return{tokenize:i.tokenizer,mode:"bbcode",last:null}},token:function(e,t){var n=t.tokenize(e,t);return t.last=r,n},electricChars:""}}),CodeMirror.defineMIME("text/x-bbcode","bbcode");